# ğŸ‰ v1.2.0 å‘å¸ƒè¯´æ˜

## å‘å¸ƒä¿¡æ¯

**ç‰ˆæœ¬**: 1.2.0  
**å‘å¸ƒæ—¥æœŸ**: 2025-11-04  
**ç±»å‹**: åŠŸèƒ½ç‰ˆæœ¬ (Feature Release)

---

## ğŸŒŸ é‡å¤§åŠŸèƒ½

### 1. å¤šæ¨¡å¼è·¯ç”± (Multi-Modal Routing)

ç°åœ¨æ”¯æŒä¸‰ç§äº¤é€šæ–¹å¼ï¼Œæ¯ç§éƒ½æœ‰ä¼˜åŒ–çš„è·¯çº¿è®¡ç®—ï¼

```bash
# ğŸš— æ±½è½¦ - å¿«é€Ÿé“è·¯ä¼˜å…ˆ
curl -X POST http://localhost:8080/route -d '{"from_lat": 43.73, "from_lon": 7.42, "to_lat": 43.74, "to_lon": 7.43, "profile": "car"}'

# ğŸš´ è‡ªè¡Œè½¦ - è‡ªè¡Œè½¦é“ä¼˜å…ˆ  
curl -X POST http://localhost:8080/route -d '{"from_lat": 43.73, "from_lon": 7.42, "to_lat": 43.74, "to_lon": 7.43, "profile": "bike"}'

# ğŸš¶ æ­¥è¡Œ - å¯èµ°äººè¡Œé“å’Œæ¥¼æ¢¯
curl -X POST http://localhost:8080/route -d '{"from_lat": 43.73, "from_lon": 7.42, "to_lat": 43.74, "to_lon": 7.43, "profile": "foot"}'
```

### 2. è½¬å¼¯é™åˆ¶ (Turn Restrictions)

è‡ªåŠ¨è§£æ OSM è½¬å¼¯é™åˆ¶ï¼Œç¡®ä¿è·¯çº¿åˆæ³•ï¼

- âœ… è§£æ Monaco æ•°æ®é›†ä¸­çš„ **44 ä¸ªè½¬å¼¯é™åˆ¶**
- âœ… æ”¯æŒæ‰€æœ‰ OSM æ ‡å‡†é™åˆ¶ç±»å‹
- âœ… è‡ªåŠ¨åº”ç”¨ï¼Œæ— éœ€é…ç½®

**æ”¯æŒç±»å‹:**
- ç¦æ­¢: `no_left_turn`, `no_right_turn`, `no_u_turn`, `no_straight_on`
- ä»…å…è®¸: `only_left_turn`, `only_right_turn`, `only_straight_on`

### 3. å¢å¼ºå•è¡Œé“ (Enhanced Oneway)

å®Œæ•´æ”¯æŒåŒ…æ‹¬åå‘å•è¡Œé“ï¼

- âœ… `oneway=yes` - æ­£å‘å•è¡Œ
- âœ… `oneway=-1` - **åå‘å•è¡Œï¼ˆæ–°å¢ï¼‰**
- âœ… `oneway=reverse` - åå‘å•è¡Œ
- âœ… é˜²æ­¢é€†è¡Œè·¯çº¿

---

## ğŸ“¦ æ–°å¢å†…å®¹

### æ ¸å¿ƒä»£ç 
- `internal/routing/profile.go` - è·¯ç”±é…ç½®ç³»ç»Ÿ
- `internal/graph/restrictions.go` - è½¬å¼¯é™åˆ¶

### æ–‡æ¡£ (6 ä¸ªæ–°æ–‡æ¡£ï¼)
- `docs/PROFILES_GUIDE.md` - é…ç½®å®Œæ•´æŒ‡å—
- `docs/FEATURES_IMPLEMENTED.md` - åŠŸèƒ½å®ç°è¯¦æƒ…
- `docs/ROADMAP_PRIORITY.md` - Roadmap ä¼˜å…ˆçº§åˆ†æ
- `docs/RESTRICTIONS_GUIDE.md` - é™åˆ¶è¯¦ç»†è¯´æ˜
- `UPGRADE_GUIDE.md` - å‡çº§æŒ‡å—
- `FEATURES_V1.2.md` - åŠŸèƒ½æ€»ç»“

### ç¤ºä¾‹ä»£ç 
- `examples/test_profiles.sh` - Profile æµ‹è¯•è„šæœ¬
- `examples/profile_comparison.py` - Python å¯¹æ¯”å·¥å…·

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å…¨æ–°å®‰è£…

```bash
cd /Users/lmc10232/project/nav

# 1. ä¸‹è½½ç¤ºä¾‹æ•°æ®
make download-sample

# 2. è¿è¡ŒæœåŠ¡å™¨
make run-sample

# 3. æµ‹è¯•æ–°åŠŸèƒ½
curl -X POST http://localhost:8080/route \
  -H "Content-Type: application/json" \
  -d '{
    "from_lat": 43.73,
    "from_lon": 7.42,
    "to_lat": 43.74,
    "to_lon": 7.43,
    "profile": "bike"
  }'
```

### ä» v1.0/v1.1 å‡çº§

```bash
# âš ï¸ é‡è¦: åˆ é™¤æ—§ç¼“å­˜
rm graph.bin.gz

# é‡æ–°è§£æåŒ…å«é™åˆ¶
OSM_DATA_PATH=monaco-latest.osm.pbf go run cmd/server/main.go
```

è¯¦è§: [UPGRADE_GUIDE.md](UPGRADE_GUIDE.md)

---

## ğŸ“Š æ•°æ®ç»Ÿè®¡

### Monaco æ•°æ®é›†

```
Loaded 7427 nodes, 1228 routable ways, and 44 turn restrictions
Graph built: 7427 nodes, 11914 edges
```

- **èŠ‚ç‚¹**: 7,427
- **è¾¹**: 11,914
- **è½¬å¼¯é™åˆ¶**: 44 â­
- **å•è¡Œé“**: ~100
- **åå‘å•è¡Œé“**: ~5 â­

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. å¤šæ¨¡å¼å‡ºè¡Œ App

```python
# ä¸ºç”¨æˆ·æä¾›æ‰€æœ‰é€‰é¡¹
modes = ['car', 'bike', 'foot']
routes = {}

for mode in modes:
    route = find_route(from, to, profile=mode)
    routes[mode] = {
        'distance': route['distance'],
        'duration': route['duration']
    }

# ç”¨æˆ·å¯ä»¥é€‰æ‹©æœ€é€‚åˆçš„æ–¹å¼
```

### 2. è‡ªè¡Œè½¦å¯¼èˆª

```javascript
// ä¸“é—¨çš„è‡ªè¡Œè½¦åº”ç”¨
const bikeRoute = await fetch('/route', {
  method: 'POST',
  body: JSON.stringify({
    from_lat: userLat,
    from_lon: userLon,
    to_lat: destLat,
    to_lon: destLon,
    profile: 'bike',       // è‡ªè¡Œè½¦ä¸“å±
    format: 'polyline'     // èŠ‚çœæµé‡
  })
});
```

### 3. æ­¥è¡Œå¯¼èˆª

```python
# æ­¥è¡Œå¯ä»¥èµ°æ·å¾„
pedestrian_route = requests.post('/route', json={
    'from_lat': 43.73,
    'from_lon': 7.42,
    'to_lat': 43.74,
    'to_lon': 7.43,
    'profile': 'foot'  # å¯ä»¥ä½¿ç”¨æ¥¼æ¢¯ã€äººè¡Œé“
})
```

---

## âœ… è´¨é‡ä¿è¯

### æµ‹è¯•è¦†ç›–

- âœ… ç¼–è¯‘æµ‹è¯•: é€šè¿‡
- âœ… åŠŸèƒ½æµ‹è¯•: é€šè¿‡
- âœ… Profile åˆ‡æ¢: é€šè¿‡
- âœ… è½¬å¼¯é™åˆ¶: è‡ªåŠ¨åº”ç”¨
- âœ… å‘åå…¼å®¹: 100%

### æ–‡æ¡£å®Œæ•´æ€§

- âœ… API æ–‡æ¡£: å®Œæ•´æ›´æ–°
- âœ… ä½¿ç”¨æŒ‡å—: 6 ä¸ªæ–°æ–‡æ¡£
- âœ… ä»£ç ç¤ºä¾‹: Python, Bash, JavaScript
- âœ… å‡çº§æŒ‡å—: è¯¦ç»†æ­¥éª¤

---

## ğŸ“– å®Œæ•´ API å‚è€ƒ

### POST /route

```json
{
  "from_lat": 43.73,
  "from_lon": 7.42,
  "to_lat": 43.74,
  "to_lon": 7.43,
  "profile": "bike",        // â­ æ–°å¢
  "alternatives": 2,
  "format": "geojson"
}
```

### GET /route/get

```
/route/get?from_lat=43.73&from_lon=7.42&to_lat=43.74&to_lon=7.43&profile=foot&format=polyline
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ^^^^^^^^^^^^^ ^^^^^^^^^^^^^^
           åæ ‡ï¼ˆå¿…éœ€ï¼‰                                        æ–°å¢å‚æ•°      å·²æœ‰å‚æ•°
```

---

## ğŸ” æŠ€æœ¯äº®ç‚¹

### 1. æ™ºèƒ½çŠ¶æ€è¿½è¸ª

**v1.0:**
```go
state = nodeID  // åªè®°å½•ä½ç½®
```

**v1.2:**
```go
state = (nodeID, prevWayID)  // ä½ç½® + æ¥æºè·¯æ®µ
```

**å¥½å¤„:** å¯ä»¥æ£€æŸ¥è½¬å¼¯åˆæ³•æ€§

### 2. Profile ç³»ç»Ÿè®¾è®¡

```go
type RoutingProfile struct {
    AllowedHighways map[string]bool       // è¿‡æ»¤
    SpeedFactors    map[string]float64    // æƒé‡
    AvoidSurfaces   map[string]bool       // é¿å…
}
```

**ç‰¹ç‚¹:**
- é¢„è®¾é…ç½® (car/bike/foot)
- æ˜“äºæ‰©å±•
- åŠ¨æ€åº”ç”¨

### 3. é™åˆ¶ç¼“å­˜

```go
type ExportData struct {
    Nodes        map[int64]*Node
    Edges        map[int64][]Edge
    Restrictions map[int64][]TurnRestriction  // æ–°å¢
}
```

**å¥½å¤„:** é™åˆ¶æ•°æ®ä¹Ÿè¢«ç¼“å­˜ï¼ŒåŠ è½½é€Ÿåº¦å¿«

---

## ğŸ Bonus åŠŸèƒ½

### è‡ªåŠ¨ä¼˜åŒ–

æ¯ç§ profile éƒ½æœ‰æ™ºèƒ½æƒé‡è®¡ç®—:

**æ±½è½¦:**
- é«˜é€Ÿå…¬è·¯: distance / 1.2 = æ›´çŸ­æƒé‡ï¼ˆä¼˜å…ˆï¼‰
- å±…æ°‘åŒº: distance / 0.8 = æ›´é•¿æƒé‡ï¼ˆé¿å…ï¼‰

**è‡ªè¡Œè½¦:**
- è‡ªè¡Œè½¦é“: distance / 1.2ï¼ˆä¼˜å…ˆï¼‰
- ä¸»å¹²é“: distance / 0.7ï¼ˆé¿å…ï¼Œä¸å®‰å…¨ï¼‰

**æ­¥è¡Œ:**
- äººè¡Œé“: distance / 1.2ï¼ˆä¼˜å…ˆï¼‰
- æ¥¼æ¢¯: distance / 0.8ï¼ˆè¾ƒæ…¢ï¼‰

---

## ğŸ“š å­¦ä¹ èµ„æº

### æ–‡æ¡£å¯¼èˆª

1. **å¿«é€Ÿä¸Šæ‰‹**: [QUICKSTART.md](QUICKSTART.md)
2. **é…ç½®æŒ‡å—**: [docs/PROFILES_GUIDE.md](docs/PROFILES_GUIDE.md)
3. **é™åˆ¶æŒ‡å—**: [docs/RESTRICTIONS_GUIDE.md](docs/RESTRICTIONS_GUIDE.md)
4. **å‡çº§æŒ‡å—**: [UPGRADE_GUIDE.md](UPGRADE_GUIDE.md)
5. **å®Œæ•´æ–‡æ¡£**: [README.md](README.md)

### ä»£ç ç¤ºä¾‹

- Bash: `examples/test_profiles.sh`
- Python: `examples/profile_comparison.py`
- Go: `examples/client_example.go`

---

## ğŸ”® ä¸‹ä¸€æ­¥

### v1.3.0 è®¡åˆ’

æ ¹æ® [docs/ROADMAP_PRIORITY.md](docs/ROADMAP_PRIORITY.md):

1. **Performance Benchmarks** - æ€§èƒ½åŸºå‡†æµ‹è¯•
2. **Bidirectional A*** - åŒå‘æœç´¢ä¼˜åŒ–

é¢„è®¡å‘å¸ƒ: 2-3 å‘¨å†…

---

## ğŸ’¬ åé¦ˆ

æ¬¢è¿åé¦ˆå’Œå»ºè®®ï¼

- ğŸ“§ Issues: GitHub Issues
- ğŸ“– æ–‡æ¡£: è¯¦è§ docs/ ç›®å½•
- ğŸ§ª æµ‹è¯•: examples/ ç›®å½•

---

## âœ¨ æ€»ç»“

**v1.2.0 - å¤šæ¨¡å¼è·¯ç”±ç‰ˆæœ¬**

âœ… **3 ç§è·¯ç”±é…ç½®** - æ±½è½¦ã€è‡ªè¡Œè½¦ã€æ­¥è¡Œ  
âœ… **è‡ªåŠ¨è½¬å¼¯é™åˆ¶** - 44+ é™åˆ¶ï¼ˆMonacoï¼‰  
âœ… **å®Œæ•´å•è¡Œé“** - åŒ…æ‹¬åå‘å•è¡Œ  
âœ… **å‘åå…¼å®¹** - 100% API å…¼å®¹  
âœ… **æ–‡æ¡£å®Œå–„** - 6 ä¸ªæ–°æ–‡æ¡£  
âœ… **ç”Ÿäº§å°±ç»ª** - å¯ç«‹å³éƒ¨ç½²  

æ„Ÿè°¢ä½¿ç”¨ï¼ğŸ‰ğŸ—ºï¸

